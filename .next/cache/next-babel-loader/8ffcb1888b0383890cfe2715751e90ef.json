{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _objectWithoutProperties from \"@babel/runtime-corejs2/helpers/esm/objectWithoutProperties\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport React from 'react';\nimport App, { Container } from 'next/app';\nimport NProgress from 'nprogress';\nimport routes, { Router } from '../routes';\nimport nextCookie from 'next-cookies';\nimport jwt from 'jsonwebtoken';\nRouter.events.on('routeChangeStart', function (url) {\n  console.log(\"Loading: \".concat(url));\n  NProgress.start();\n});\nRouter.events.on('routeChangeComplete', function () {\n  return NProgress.done();\n});\nRouter.events.on('routeChangeError', function () {\n  return NProgress.done();\n});\n\nvar SabinApp =\n/*#__PURE__*/\nfunction (_App) {\n  _inherits(SabinApp, _App);\n\n  function SabinApp() {\n    _classCallCheck(this, SabinApp);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(SabinApp).apply(this, arguments));\n  }\n\n  _createClass(SabinApp, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          Component = _this$props.Component,\n          rest = _objectWithoutProperties(_this$props, [\"Component\"]);\n\n      return React.createElement(Container, null, React.createElement(Component, rest));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(_ref) {\n        var Component, ctx, protocol, baseUrl, apiUrl, route, _nextCookie, token, auth, pageProps;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                Component = _ref.Component, ctx = _ref.ctx;\n                // const protocol = process.env.NODE_ENV === 'production' ? 'https' : 'http'\n                protocol = 'http';\n                baseUrl = process.browser ? \"\".concat(protocol, \"://\").concat(window.location.host) : \"\".concat(protocol, \"://\").concat(ctx.req.hostname);\n                apiUrl = process.env.API_HOST || \"\".concat(protocol, \"://localhost:3000\");\n                route = routes.match(ctx.asPath);\n                _nextCookie = nextCookie(ctx), token = _nextCookie.token;\n                auth = token && jwt.verify(token, 'SECRET');\n                ctx.apiUrl = apiUrl;\n                ctx.route = route;\n                ctx.token = token;\n                _context.t0 = Component.getInitialProps;\n\n                if (!_context.t0) {\n                  _context.next = 15;\n                  break;\n                }\n\n                _context.next = 14;\n                return Component.getInitialProps(ctx);\n\n              case 14:\n                _context.t0 = _context.sent;\n\n              case 15:\n                pageProps = _context.t0;\n                return _context.abrupt(\"return\", _objectSpread({}, pageProps, {\n                  apiUrl: apiUrl,\n                  route: route,\n                  token: token,\n                  baseUrl: baseUrl,\n                  auth: auth\n                }));\n\n              case 17:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function getInitialProps(_x) {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  return SabinApp;\n}(App);\n\nexport { SabinApp as default };","map":null,"metadata":{},"sourceType":"module"}